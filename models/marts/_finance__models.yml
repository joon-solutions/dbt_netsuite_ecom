version: 2

models:
  - name: dim_erp__customers
    description: "Dimension table containing information about customers. THE TABLE CONTENT PII INFORMATION, USE IT CAREFULLY"
    config:
      contract:
        enforced: true       
    columns:
      - name: customer_id
        description: "The unique identifier for the customer."
        tests:
          - unique
          - not_null
        data_type: number(38,0)
      - name: external_id
        description: "The external identifier for the customer."
        data_type: text
      - name: company_name
        description: "The name of the customer company."
        data_type: text
      - name: parent_id
        description: "The unique identifier of the parent company of the customer."
        data_type: number(38,0)
      - name: parent_name
        description: "The name of the parent company of the customer."
        data_type: text
      - name: department_full_name
        description: "The full name of the department associated with the customer."
        data_type: text
      - name: phone
        description: "The phone number of the customer."
        data_type: text
      - name: email
        description: "The email address of the customer."
        data_type: text
      - name: default_address_id
        description: "The default address identifier for the customer."
        data_type: number(38,0)
      - name: addr_text
        description: "The text of the address associated with the customer."
        data_type: text
      - name: state
        description: "The state of the customer."
        data_type: text
      - name: country
        description: "The country of the customer."
        data_type: text
      - name: entity_status
        description: "The status of the entity associated with the customer."
        data_type: text
      - name: entity_id
        description: "The unique identifier of the entity associated with the customer."
        data_type: number(38,0)
      - name: primary_subsidiary_name
        description: "The name of the primary subsidiary associated with the customer."
        data_type: text

  - name: dim_erp__items
    config:
      contract:
        enforced: true  
    description: "Dimension table containing information about items (products)"
    columns:
      - name: item_id
        description: "The unique identifier for the item."
        data_type: number(38,0)
        tests:
          - unique
          - not_null        
      - name: sku
        description: "The stock-keeping unit (SKU) for the item."
        data_type: text
      - name: item_display_name
        description: "The display name of the item."
        data_type: text
      - name: item_description
        description: "The description of the item."
        data_type: text
      - name: item_type
        description: "The type of the item."
        data_type: text
      - name: is_inactive
        description: "Specifies whether the item is inactive."
        data_type: boolean
      - name: unit_cost
        description: "The unit cost of the item."
        data_type: float
      - name: item_weight
        description: "The weight of the item."
        data_type: float
      - name: item_weight_lb
        description: "The weight of the item in pound (lbs)."
        data_type: float        
      - name: org_sku
        description: "The original SKU of the item."
        data_type: text
      - name: weight_unit
        description: "The unit of weight for the item."
        data_type: text
      - name: class_id
        description: "The unique identifier of the classification associated with the item."
        data_type: number(38,0)
      - name: parent_class_id
        description: "The unique identifier of the parent classification associated with the item."
        data_type: number(38,0)
      - name: class_name
        description: "The name of the classification associated with the item."
        data_type: text

  - name: fct_erp__budget
    description: "Fact table containing budget information."
    config:
      contract:
        enforced: true       
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - budget_id
            - accounting_period_id
    columns:
      - name: budget_id
        description: "The unique identifier for the budget."
        data_type: number(38,0)
      - name: accounting_period_id
        description: "The identifier for the accounting period."
        data_type: number(38,0)
        tests:
          - not_null        
      - name: subsidiary_id
        description: "The unique identifier for the subsidiary."
        data_type: number(38,0)
        tests:
          - not_null        
      - name: account_id
        description: "The unique identifier for the account."
        data_type: number(38,0)
        tests:
          - not_null        
      - name: currency_id
        description: "The unique identifier for the currency."
        data_type: number(38,0)
      - name: customer_id
        description: "The unique identifier for the customer."
        data_type: number(38,0)
      - name: class_id
        description: "The unique identifier for the classification."
        data_type: number(38,0)
      - name: department_id
        description: "The unique identifier for the department."
        data_type: number(38,0)
      - name: subsidiary_name
        description: "The name of the subsidiary."
        data_type: text
      - name: account_name
        description: "The name of the account."
        data_type: text
      - name: is_sales_account
        description: "Specifies whether the budget belongs to a sales account."
        data_type: boolean
      - name: is_cogs_account
        description: "Specifies whether the budget belongs to a cost of goods sold account."
        data_type: boolean
      - name: currency
        description: "The currency of the budget."
        data_type: text
      - name: department_full_name
        description: "The full name of the department."
        data_type: text
      - name: budget_month
        description: "The month of the budget."
        data_type: timestamp_tz
      - name: amount_monthly
        description: "The monthly amount of the budget."
        data_type: float
      - name: class_name
        description: "The name of the classification."
        data_type: text

  - name: fct_erp__transaction_lines
    columns:
      - name: unique_key
        tests:
          - unique
          - not_null
    tests:
      - dbt_utils.expression_is_true:
          expression: "amount_debit >= 0"          
      - dbt_utils.expression_is_true:
          expression: "amount_credit >= 0"      

  - name: fct_erp__consolidated_exchange_rate
    description: This table holds the CER for each account at each accounting(posting) period
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - account_id
            - posting_period_id
            - from_subsidiary_id
            - to_subsidiary_id
